# Python Lightroom Tool

一个基于 Python 的 Lightroom 风格图像编辑工具，支持非破坏性编辑。

## 功能特性

- 非破坏性编辑：永远不修改原始文件，通过参数栈实时计算效果
- 支持 JPG、PNG、BMP、TIFF 等常见图像格式
- 实时预览编辑效果
- 预设导入/导出功能

## 已实现功能模块

### 基本调整面板 (Basic Panel) ✅
| 功能 | 参数范围 | 说明 |
|------|----------|------|
| 曝光 | -100 ~ +100 | 调整整体亮度，影响中间调 |
| 对比度 | -100 ~ +100 | 调整画面明暗反差 |
| 高光 | -100 ~ +100 | 调整画面中最亮的部分 |
| 阴影 | -100 ~ +100 | 调整画面中最暗的部分 |
| 白色色阶 | -100 ~ +100 | 调整图像最亮端的极限值 |
| 黑色色阶 | -100 ~ +100 | 调整图像最暗端的极限值 |

### 效果调整面板 (Effects Panel) ✅
| 功能 | 参数范围 | 说明 |
|------|----------|------|
| 纹理 | -100 ~ +100 | 增强/平滑中等尺度细节 |
| 清晰度 | -100 ~ +100 | 通过局部对比度增强深度和质感 |
| 去朦胧 | -100 ~ +100 | 移除或添加画面中的雾霾感 |

### 颜色面板 (Color Panel) ✅

#### 白平衡
| 功能 | 参数范围 | 说明 |
|------|----------|------|
| 色温 | -100 ~ +100 | 调整画面冷暖色调（负值偏蓝，正值偏黄） |
| 色调 | -150 ~ +150 | 调整画面绿/洋红偏色 |

#### HSL 颜色混合器
对 8 种颜色（红、橙、黄、绿、青、蓝、紫、洋红）分别调整：
| 功能 | 参数范围 | 说明 |
|------|----------|------|
| 色相 | -100 ~ +100 | 改变所选颜色的色彩 |
| 饱和度 | -100 ~ +100 | 改变所选颜色的鲜艳程度 |
| 明度 | -100 ~ +100 | 改变所选颜色的亮度 |

#### 颜色分级
| 功能 | 参数范围 | 说明 |
|------|----------|------|
| 阴影色相 | 0 ~ 360° | 为阴影区域添加色彩 |
| 阴影饱和度 | 0 ~ 100 | 阴影颜色浓淡 |
| 高光色相 | 0 ~ 360° | 为高光区域添加色彩 |
| 高光饱和度 | 0 ~ 100 | 高光颜色浓淡 |
| 混合 | 0 ~ 100 | 控制色调区域过渡平滑度 |
| 平衡 | -100 ~ +100 | 控制效果在阴影和高光之间的偏向 |

#### 基础颜色调整
| 功能 | 参数范围 | 说明 |
|------|----------|------|
| 鲜艳度 | -100 ~ +100 | 智能调整低饱和度颜色 |
| 饱和度 | -100 ~ +100 | 统一调整所有颜色饱和度 |

### 细节面板 (Detail Panel) ✅

#### 锐化
| 功能 | 参数范围 | 说明 |
|------|----------|------|
| 数量 | 0 ~ 150 | 控制锐化强度 |
| 半径 | 0.5 ~ 3.0 | 控制锐化边缘周围的像素范围 |
| 细节 | 0 ~ 100 | 控制锐化在纹理上的强调程度 |
| 遮罩 | 0 ~ 100 | 控制锐化效果的蒙版范围 |

#### 降噪
| 功能 | 参数范围 | 说明 |
|------|----------|------|
| 明度 | 0 ~ 100 | 减少黑白颗粒状的明度噪点 |
| 颜色 | 0 ~ 100 | 减少彩色斑点的颜色噪点 |

### 预设功能 ✅
| 功能 | 说明 |
|------|------|
| 导入预设 | 从 JSON 文件加载编辑参数 |
| 导出预设 | 将当前编辑参数保存为 JSON 文件 |

### 其他已实现功能 ✅
- 图像加载与显示（支持缩放预览）
- 编辑后图像保存（全分辨率输出）
- 参数重置功能
- 快捷键支持

## 环境要求

- Python 3.10+
- Conda（推荐）

## 安装步骤

### 1. 创建 Conda 环境

```bash
# 创建并激活环境
conda env create -f environment.yml
conda activate lightroom
```

或者手动创建：

```bash
conda create -n lightroom python=3.10
conda activate lightroom
conda install -c conda-forge pyqt pillow numpy scipy
```

### 2. 运行程序

```bash
cd lightroom_python
python main.py
```

或者在 Windows 上双击 `run.bat`

## 使用说明

### 打开图像
- 点击菜单 `文件 -> 打开` 或工具栏 `打开` 按钮
- 支持格式：JPG, JPEG, PNG, BMP, TIF, TIFF

### 编辑图像
- 在右侧编辑面板调整各项参数
- 参数调整会实时反映在图像预览中
- 所有编辑均为非破坏性，可随时重置

### 保存图像
- 点击菜单 `文件 -> 保存` 或工具栏 `保存` 按钮
- 选择保存路径和格式

### 使用预设
- **导入预设**：`文件 -> 导入预设` 或工具栏 `导入预设` 按钮
- **导出预设**：`文件 -> 导出预设` 或工具栏 `导出预设` 按钮
- 预设文件格式为 JSON，可分享给他人使用

### 重置编辑
- 点击工具栏 `重置` 按钮或编辑面板 `重置所有调整` 按钮
- 所有参数恢复为默认值

## 快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+O | 打开图像 |
| Ctrl+S | 保存图像 |
| Ctrl+I | 导入预设 |
| Ctrl+E | 导出预设 |
| Ctrl+Q | 退出程序 |

## 项目结构

```
lightroom_python/
├── main.py              # 应用入口
├── environment.yml      # Conda 环境配置
├── requirements.txt     # pip 依赖
├── run.bat              # Windows 启动脚本
├── setup_env.bat        # 环境安装脚本（Windows）
├── setup_env.sh         # 环境安装脚本（Linux/Mac）
├── ui/
│   ├── __init__.py
│   └── main_window.py   # 主窗口 UI
├── core/
│   ├── __init__.py
│   └── editor.py        # 图像编辑核心功能
├── utils/
│   ├── __init__.py
│   └── file_utils.py    # 文件操作工具
└── tests/
    ├── __init__.py
    └── test_features.py # 功能测试脚本
```

## 技术栈

- **GUI 框架**: PyQt5
- **图像处理**: Pillow (PIL), NumPy
- **科学计算**: SciPy（用于高斯模糊等高级图像处理）

## 开发计划

- [ ] 裁剪工具
- [ ] 曲线调整
- [ ] 局部调整（画笔/渐变滤镜）
- [ ] 批量处理
- [ ] RAW 格式支持
